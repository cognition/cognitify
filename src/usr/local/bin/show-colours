#!/usr/bin/env bash
# Display Cognitify colour names in their actual colours
# (c) 2026 Ramon Brooker <rbrooker@aeo3.io>

# Source the colour definitions if available
COLOUR_FILE=""
if [[ -f /etc/bash.bashrc.d/lib/cognitifyColours ]]; then
    COLOUR_FILE="/etc/bash.bashrc.d/lib/cognitifyColours"
elif [[ -f "src/bash.bashrc.d/lib/cognitifyColours" ]]; then
    COLOUR_FILE="src/bash.bashrc.d/lib/cognitifyColours"
elif [[ -f "${BASH_SOURCE[0]%/*}/../../src/bash.bashrc.d/lib/cognitifyColours" ]]; then
    COLOUR_FILE="${BASH_SOURCE[0]%/*}/../../src/bash.bashrc.d/lib/cognitifyColours"
fi

if [[ -n "$COLOUR_FILE" ]]; then
    # shellcheck source=/dev/null
    source "$COLOUR_FILE"
fi

# Function to print colour name in its colour
print_colour() {
    local name="$1"
    local colour_var="$2"
    local colour_value
    
    # Get the colour value
    eval "colour_value=\$${colour_var}"
    
    if [[ -z "$colour_value" ]]; then
        printf "%-20s (not defined)\n" "$name:"
        return
    fi
    
    # Print with colour - extract the actual ANSI code
    printf "%-20s " "$name:"
    
    # Remove bash prompt brackets \[ and \] and extract ANSI code
    # Format is: [38;5;XXXm\] - we need [38;5;XXXm
    local ansi_code="${colour_value}"
    ansi_code="${ansi_code//\\\[/}"  # Remove \[
    ansi_code="${ansi_code//\\\]/}"  # Remove \]
    
    # Print using the escape sequence directly
    printf "\033${ansi_code}${name}\033[0m\n"
}

# Function to print using direct escape sequence
print_colour_direct() {
    local name="$1"
    local escape_seq="$2"
    
    printf "%-20s " "$name:"
    printf "\033${escape_seq}${name}\033[0m\n"
}

echo "Cognitify Colour Palette"
echo "========================"
echo ""

# Text colours
if [[ -n "${OFF_WHITE:-}" ]]; then
    print_colour "OFF_WHITE" "OFF_WHITE"
fi

if [[ -n "${WARM_WHITE:-}" ]]; then
    print_colour "WARM_WHITE" "WARM_WHITE"
fi

if [[ -n "${EASY_WHITE:-}" ]]; then
    print_colour "EASY_WHITE" "EASY_WHITE"
fi

if [[ -n "${GRAY:-}" ]]; then
    print_colour "GRAY" "GRAY"
fi

if [[ -n "${YELLO:-}" ]]; then
    printf "%-20s " "YELLO:"
    # YELLO uses tput, so it's already evaluated
    printf "${YELLO}YELLO${NC:-\\033[0m}\n"
fi

if [[ -n "${GOLD:-}" ]]; then
    print_colour "GOLD" "GOLD"
fi

if [[ -n "${ORANGE:-}" ]]; then
    print_colour "ORANGE" "ORANGE"
fi

if [[ -n "${LT_BLUE:-}" ]]; then
    print_colour "LT_BLUE" "LT_BLUE"
fi

if [[ -n "${AZURE:-}" ]]; then
    print_colour "AZURE" "AZURE"
fi

if [[ -n "${PINK:-}" ]]; then
    print_colour "PINK" "PINK"
fi

if [[ -n "${BRIGHT_PINK:-}" ]]; then
    print_colour "BRIGHT_PINK" "BRIGHT_PINK"
fi

if [[ -n "${ROOT_RED:-}" ]]; then
    print_colour "ROOT_RED" "ROOT_RED"
fi

if [[ -n "${LIME:-}" ]]; then
    print_colour "LIME" "LIME"
fi

if [[ -n "${GREEN:-}" ]]; then
    print_colour "GREEN" "GREEN"
fi

if [[ -n "${OLIVE:-}" ]]; then
    print_colour "OLIVE" "OLIVE"
fi

# Additional colours that might be defined
if [[ -n "${HOSTNAME_TWO:-}" ]]; then
    print_colour "HOSTNAME_TWO" "HOSTNAME_TWO"
fi

if [[ -n "${DEFAULT_USERNAME_COLOUR:-}" ]]; then
    print_colour "DEFAULT_USERNAME_COLOUR" "DEFAULT_USERNAME_COLOUR"
fi

if [[ -n "${TEXT_COLOUR:-}" ]]; then
    print_colour "TEXT_COLOUR" "TEXT_COLOUR"
fi

echo ""
echo "Special formatting:"
if [[ -n "${NC:-}" ]]; then
    printf "%-20s ${NC}Normal (reset)${NC}\n" "NC:"
fi

if [[ -n "${BOLD:-}" ]]; then
    printf "%-20s " "BOLD:"
    # BOLD uses tput, evaluate it directly
    if command -v tput >/dev/null 2>&1; then
        printf "$(tput bold)Bold Text$(tput sgr0)\n"
    else
        printf "Bold Text\n"
    fi
fi

if [[ -n "${RESET:-}" ]]; then
    printf "%-20s " "RESET:"
    # RESET uses tput, evaluate it directly
    if command -v tput >/dev/null 2>&1; then
        printf "$(tput sgr0)Reset$(tput sgr0)\n"
    else
        printf "Reset\n"
    fi
fi

echo ""
echo "Usage in scripts:"
echo "  export OVERRIDE_HOSTNAME_COLOUR=\${AZURE}"
echo "  export OVERRIDE_USERNAME_COLOUR=\${LIME}"
echo "  export OVERRIDE_PWD_COLOUR=\${BRIGHT_PINK}"
echo ""
if [[ -n "$COLOUR_FILE" ]]; then
    echo "Colour definitions loaded from: $COLOUR_FILE"
else
    echo "Warning: Could not find cognitifyColours file"
    echo "Colours may not display correctly"
fi

